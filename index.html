<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALII Project Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
        }

        .tab-button {
            border-bottom-width: 3px;
            border-bottom-color: transparent;
            transition: color 0.2s ease, border-bottom-color 0.2s ease;
        }

        .tab-button.active {
            border-bottom-color: #4f46e5;
            color: #4f46e5;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .diagram-box {
            border: 2px solid #cbd5f5;
            border-radius: 0.75rem;
            padding: 1rem;
            text-align: center;
            background-color: #ffffff;
            box-shadow: 0 1px 3px rgba(15, 23, 42, 0.08);
        }

        .diagram-arrow {
            color: #475569;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 640px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 360px;
            }
        }

        .feature-content {
            display: none;
        }

        .feature-content.active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-indigo-700">Advanced Light Intensity Indicator (ALII)</h1>
            <p class="text-lg text-slate-600 mt-2">Interactive Project Analysis Dashboard</p>
        </header>

        <nav class="flex justify-center border-b border-slate-300 mb-8" id="tab-nav">
            <button class="tab-button active text-sm md:text-base py-3 px-4 md:px-6" data-tab="overview">Overview</button>
            <button class="tab-button text-sm md:text-base py-3 px-4 md:px-6" data-tab="core-component">Core Component (Lab)</button>
            <button class="tab-button text-sm md:text-base py-3 px-4 md:px-6" data-tab="system-design">System Design</button>
            <button class="tab-button text-sm md:text-base py-3 px-4 md:px-6" data-tab="feature-explorer">Feature Explorer</button>
        </nav>

        <main id="tab-content-wrapper">

            <section id="overview" class="tab-content active space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-semibold text-indigo-700 mb-3">Project Objective</h2>
                    <p class="text-slate-700 leading-relaxed">The ALII module monitors light intensity levels and provides an average intensity over a specified period. This dashboard summarizes requirements from `DSP_Project.pdf` and `ADC_Lab.pdf`, highlighting goals, components, and theory of operation.</p>
                </div>

                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-semibold text-indigo-700 mb-3">Key Benefits</h3>
                        <ul class="list-disc list-outside pl-5 space-y-2 text-slate-700">
                            <li><strong>Energy Conservation:</strong> Optimize artificial lighting by tracking real illumination levels.</li>
                            <li><strong>Safer Cities:</strong> Ensure public spaces stay well-lit to reduce accidents and crime.</li>
                            <li><strong>Renewable Integration:</strong> Clean analog chain pairs naturally with solar-powered deployments.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                        <h3 class="text-xl font-semibold text-indigo-700 mb-3">Design Constraints</h3>
                        <ul class="list-disc list-outside pl-5 space-y-2 text-slate-700">
                            <li><span class="font-semibold text-red-600">NO</span> programmable ICs (microcontrollers, DSPs, FPGAs).</li>
                            <li><span class="font-semibold text-red-600">NO</span> task-specific ICs (dedicated ADC or timer chips).</li>
                            <li><span class="font-semibold text-green-600">YES</span> to basic gates, flip-flops, op-amps, encoders, decoders.</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <details>
                        <summary class="cursor-pointer text-lg font-semibold text-indigo-700">Comprehensive Theory & BOM (click to expand)</summary>
                        <div class="mt-4 space-y-4 text-slate-700 leading-relaxed max-h-[460px] overflow-y-auto pr-2">
                            <p>The ALII adopts a mixed-signal architecture that couples photoconductive sensing with discrete-time logic. The system enforces a strict analog-digital partition that eliminates programmable devices, ensuring deterministic behavior.</p>
                            <p><strong>Signal Chain:</strong> LDR voltage divider → active Sallen-Key filter → Flash ADC (LM339 + 74HC148 + 74HC04 + CD4511) → latch logic → dual-display subsystem for instantaneous and averaged readings.</p>
                            <p><strong>Stability Engine:</strong> Differentiator, window comparator, CD4060 timer and NAND one-shot sequence gate the CD4511 latch so only stable inputs appear on the “Current” display.</p>
                            <p><strong>Averager:</strong> RC-based analog averaging plus VCO (NE555) and counter chain (CD4040 + CD4026) to convert long-term integration into a second display channel.</p>
                            <p><strong>Power:</strong> 12 V solar and SLA battery stack regulated by LM7805, with charge protection via Zener-controlled shunt transistor.</p>
                            <p><strong>Key Components:</strong> GL5528 LDR, LM358 op-amp, LM339 comparators, 74HC148 encoder, 74HC04 inverters, CD4511 BCD decoder, CD4060 timers, LM393 comparators, CD4093 NANDs, NE555 VCO, CD4040 divider, CD4026 counter, dual 7-segment displays, assorted resistors/capacitors/pots.</p>
                            <p>The full textual analysis from the project brief is preserved in <code>DSP.txt</code> for reference.</p>
                        </div>
                    </details>
                </div>
            </section>

            <section id="core-component" class="tab-content space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-semibold text-indigo-700 mb-3">Core Component: Flash ADC</h2>
                    <p class="text-slate-700 leading-relaxed mb-6">The Flash ADC converts the filtered analog voltage from the LDR into a digital level for the seven-segment display. Built from LM339 comparators, a precision resistor ladder, a 74HC148 priority encoder, and a CD4511 decoder, it mirrors the ADC lab’s reference design.</p>

                    <div class="p-4 bg-slate-50 rounded-lg">
                        <h4 class="text-lg font-semibold text-slate-800 mb-3 text-center">Flash ADC Signal Flow</h4>
                        <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                            <div class="diagram-box w-48">
                                <span class="text-sm font-medium text-slate-500">Input</span>
                                <h5 class="text-lg font-semibold">Analog Voltage</h5>
                                <span class="text-sm">(LDR divider)</span>
                            </div>
                            <span class="diagram-arrow transform md:rotate-0 rotate-90">→</span>
                            <div class="diagram-box w-48">
                                <span class="text-sm font-medium text-slate-500">Stage 1</span>
                                <h5 class="text-lg font-semibold">Comparators</h5>
                                <span class="text-sm">(LM339 array)</span>
                            </div>
                            <span class="diagram-arrow transform md:rotate-0 rotate-90">→</span>
                            <div class="diagram-box w-48">
                                <span class="text-sm font-medium text-slate-500">Stage 2</span>
                                <h5 class="text-lg font-semibold">Priority Encoder</h5>
                                <span class="text-sm">(74HC148)</span>
                            </div>
                            <span class="diagram-arrow transform md:rotate-0 rotate-90">→</span>
                            <div class="diagram-box w-48">
                                <span class="text-sm font-medium text-slate-500">Stage 3</span>
                                <h5 class="text-lg font-semibold">BCD Decoder</h5>
                                <span class="text-sm">(CD4511)</span>
                            </div>
                            <span class="diagram-arrow transform md:rotate-0 rotate-90">→</span>
                            <div class="diagram-box w-48">
                                <span class="text-sm font-medium text-slate-500">Output</span>
                                <h5 class="text-lg font-semibold">7-Segment</h5>
                                <span class="text-sm">Display</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="system-design" class="tab-content space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-semibold text-indigo-700 mb-3">ALII Full System Design</h2>
                    <p class="text-slate-700 leading-relaxed mb-6">The complete architecture uses two identical Flash ADC modules to output both “Current” and “Average” intensity readings. Analog conditioning steps precede each ADC, enforcing filtering, stabilization, timing, and averaging.</p>

                    <div class="p-4 bg-slate-50 rounded-lg overflow-x-auto">
                        <div class="flex flex-col items-center space-y-4">
                            <div class="diagram-box w-64">
                                <h5 class="text-lg font-semibold">LDR Voltage</h5>
                                <span class="text-sm">(Noisy Input)</span>
                            </div>
                            <span class="diagram-arrow">↓</span>

                            <div class="diagram-box w-64 border-indigo-400">
                                <span class="text-sm font-medium text-indigo-600">Feature 1</span>
                                <h5 class="text-lg font-semibold">Analog Filter</h5>
                                <span class="text-sm">(50–100 Hz attenuation)</span>
                            </div>
                            <span class="diagram-arrow">↓</span>
                            <div class="diagram-box bg-slate-100 w-64">
                                <h5 class="text-lg font-semibold">Clean Signal (V<sub>filtered</sub>)</h5>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-6 w-full max-w-4xl pt-6 border-t border-dashed border-slate-300">
                                <div class="flex flex-col items-center space-y-4">
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 border-indigo-400">
                                        <span class="text-sm font-medium text-indigo-600">Feature 3</span>
                                        <h5 class="text-lg font-semibold">Startup Timer (10–30 s)</h5>
                                        <span class="text-sm">(Comparator blanking)</span>
                                    </div>
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 bg-green-50 border-green-300">
                                        <h5 class="text-lg font-semibold">Flash ADC Module 1</h5>
                                        <span class="text-sm">(Lab core block)</span>
                                    </div>
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 bg-green-100">
                                        <h5 class="text-lg font-semibold">“Current” Display</h5>
                                        <span class="text-sm">(7-Segment)</span>
                                    </div>
                                </div>

                                <div class="flex flex-col items-center space-y-4">
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 border-indigo-400">
                                        <span class="text-sm font-medium text-indigo-600">Feature 4</span>
                                        <h5 class="text-lg font-semibold">Analog Averager</h5>
                                        <span class="text-sm">(300–900 s RC)</span>
                                    </div>
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 bg-blue-50 border-blue-300">
                                        <h5 class="text-lg font-semibold">Flash ADC Module 2</h5>
                                        <span class="text-sm">(Identical chain)</span>
                                    </div>
                                    <span class="diagram-arrow">↓</span>
                                    <div class="diagram-box w-64 bg-blue-100">
                                        <h5 class="text-lg font-semibold">“Average” Display</h5>
                                        <span class="text-sm">(7-Segment)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="feature-explorer" class="tab-content space-y-6">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-slate-200">
                    <h2 class="text-2xl font-semibold text-indigo-700 mb-3">Interactive Feature Explorer</h2>
                    <p class="text-slate-700 leading-relaxed mb-6">Explore each analog enhancement to understand how the ALII achieves noise-free, stable, and long-term light monitoring. Each visualization demonstrates the conceptual behavior only (not a live sensor feed).</p>

                    <div class="flex flex-wrap justify-center gap-3 md:gap-4 mb-6" id="feature-nav">
                        <button class="feature-button active bg-indigo-600 text-white py-2 px-4 rounded-full shadow-md" data-feature="filter">Feature 1: Filter</button>
                        <button class="feature-button bg-white text-indigo-600 py-2 px-4 rounded-full shadow" data-feature="timer">Feature 3: Timer</button>
                        <button class="feature-button bg-white text-indigo-600 py-2 px-4 rounded-full shadow" data-feature="average">Feature 4: Average</button>
                    </div>

                    <div id="feature-content-wrapper" class="bg-slate-50 p-4 md:p-6 rounded-lg border border-slate-200">
                        <div id="feature-filter" class="feature-content active space-y-4">
                            <h3 class="text-xl font-semibold text-slate-800">Feature 1: Analog Noise Filter</h3>
                            <p class="text-slate-700">A low-pass Sallen-Key filter strips 50–100 Hz mains ripple from the LDR signal, preventing comparator flutter.</p>
                            <div class="chart-container">
                                <canvas id="filterChart"></canvas>
                            </div>
                            <div class="flex flex-wrap justify-center gap-3">
                                <button id="toggleNoisy" class="bg-blue-500 text-white py-2 px-4 rounded-lg shadow">Toggle Noisy Signal</button>
                                <button id="toggleFiltered" class="bg-green-500 text-white py-2 px-4 rounded-lg shadow">Toggle Filtered Signal</button>
                            </div>
                        </div>

                        <div id="feature-timer" class="feature-content hidden space-y-4">
                            <h3 class="text-xl font-semibold text-slate-800">Feature 3: Startup Timer (10–30 s)</h3>
                            <p class="text-slate-700">The RC timer keeps the “Current” display blanked until the capacitor voltage crosses a comparator threshold. Adjust the variable resistor to change the delay.</p>
                            <div class="chart-container">
                                <canvas id="timerChart"></canvas>
                            </div>
                            <div class="text-center space-y-2">
                                <label for="timerSlider" class="font-medium">Adjustable Resistor (Sets Delay):</label>
                                <input type="range" id="timerSlider" min="10" max="30" value="15" class="w-full max-w-xs">
                                <p>Estimated Delay: <span id="timerValue" class="font-bold text-indigo-700">15</span> seconds</p>
                            </div>
                        </div>

                        <div id="feature-average" class="feature-content hidden space-y-4">
                            <h3 class="text-xl font-semibold text-slate-800">Feature 4: Average Intensity (300–900 s)</h3>
                            <p class="text-slate-700">A slow RC low-pass filter produces an analog average that feeds a second Flash ADC. Resetting restarts the accumulation.</p>
                            <div class="chart-container">
                                <canvas id="averageChart"></canvas>
                            </div>
                            <div class="text-center">
                                <button id="resetAverage" class="bg-red-500 text-white py-2 px-4 rounded-lg shadow">Reset Average</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabNav = document.getElementById('tab-nav');
            const tabContentWrapper = document.getElementById('tab-content-wrapper');

            tabNav.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const tab = e.target.dataset.tab;
                    Array.from(tabNav.children).forEach(button => button.classList.remove('active', 'bg-indigo-50'));
                    e.target.classList.add('active', 'bg-indigo-50');

                    Array.from(tabContentWrapper.children).forEach(content => {
                        content.classList.remove('active');
                        if (content.id === tab) {
                            content.classList.add('active');
                        }
                    });
                }
            });

            const featureNav = document.getElementById('feature-nav');
            const featureContentWrapper = document.getElementById('feature-content-wrapper');

            featureNav.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const feature = e.target.dataset.feature;
                    Array.from(featureNav.children).forEach(button => {
                        button.classList.remove('active', 'bg-indigo-600', 'text-white');
                        button.classList.add('bg-white', 'text-indigo-600');
                    });
                    e.target.classList.add('active', 'bg-indigo-600', 'text-white');
                    e.target.classList.remove('bg-white', 'text-indigo-600');

                    Array.from(featureContentWrapper.children).forEach(content => {
                        if (content.id === `feature-${feature}`) {
                            content.classList.add('active');
                            content.classList.remove('hidden');
                        } else {
                            content.classList.remove('active');
                            content.classList.add('hidden');
                        }
                    });
                }
            });

            let filterChart, timerChart, averageChart;

            const filterChartCtx = document.getElementById('filterChart').getContext('2d');
            const filterLabels = Array.from({ length: 200 }, (_, i) => i);
            const noisyData = filterLabels.map(x => 5 + Math.sin(x * 0.12) * 2 + Math.sin(x * 1.2) * 0.6);
            const filteredData = filterLabels.map(x => 5 + Math.sin(x * 0.12) * 2);

            filterChart = new Chart(filterChartCtx, {
                type: 'line',
                data: {
                    labels: filterLabels,
                    datasets: [
                        {
                            label: 'Noisy Signal (Input)',
                            data: noisyData,
                            borderColor: 'rgba(59, 130, 246, 0.8)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            pointRadius: 0,
                            tension: 0.15
                        },
                        {
                            label: 'Filtered Signal (Output)',
                            data: filteredData,
                            borderColor: 'rgba(34, 197, 94, 0.9)',
                            backgroundColor: 'rgba(34, 197, 94, 0.08)',
                            borderWidth: 3,
                            pointRadius: 0,
                            tension: 0.15
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'LDR Voltage (V)' } },
                        x: { title: { display: true, text: 'Time (ms)' } }
                    },
                    plugins: {
                        title: { display: true, text: 'Feature 1: Noise Filter Concept' },
                        legend: { position: 'bottom' }
                    }
                }
            });

            document.getElementById('toggleNoisy').addEventListener('click', () => {
                filterChart.setDatasetVisibility(0, !filterChart.isDatasetVisible(0));
                filterChart.update();
            });
            document.getElementById('toggleFiltered').addEventListener('click', () => {
                filterChart.setDatasetVisibility(1, !filterChart.isDatasetVisible(1));
                filterChart.update();
            });

            const timerChartCtx = document.getElementById('timerChart').getContext('2d');
            const timerLabels = Array.from({ length: 40 }, (_, i) => i);
            const baseDelay = 15;
            const makeTimerData = (delay) => timerLabels.map(x => 5 * (1 - Math.exp(-x / (delay / 3))));
            const threshold = Array(timerLabels.length).fill(3.33);

            timerChart = new Chart(timerChartCtx, {
                type: 'line',
                data: {
                    labels: timerLabels,
                    datasets: [
                        {
                            label: 'Capacitor Voltage (Vc)',
                            data: makeTimerData(baseDelay),
                            borderColor: 'rgba(239, 68, 68, 0.8)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            borderWidth: 3,
                            pointRadius: 0,
                            tension: 0.2
                        },
                        {
                            label: 'Comparator Threshold',
                            data: threshold,
                            borderColor: 'rgba(79, 70, 229, 0.8)',
                            borderDash: [6, 6],
                            borderWidth: 2,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'Voltage (V)' }, max: 5.5 },
                        x: { title: { display: true, text: 'Time (s)' } }
                    },
                    plugins: {
                        title: { display: true, text: 'Feature 3: Startup Timer Concept' },
                        legend: { position: 'bottom' }
                    }
                }
            });

            document.getElementById('timerSlider').addEventListener('input', (e) => {
                const delay = Number(e.target.value);
                document.getElementById('timerValue').textContent = delay;
                timerChart.data.datasets[0].data = makeTimerData(delay);
                timerChart.update();
            });

            const averageChartCtx = document.getElementById('averageChart').getContext('2d');
            const avgLabels = Array.from({ length: 120 }, (_, i) => i * 5);
            const currentSignal = avgLabels.map(x => 3 + Math.sin(x / 25) * 1.2 + (Math.random() - 0.5) * 0.5);
            let averageSignal = [];
            let currentAvg = 0;
            const smoothingFactor = 0.04;

            function calculateAverage(reset = false) {
                if (reset) currentAvg = 0;
                averageSignal = [];
                for (let i = 0; i < currentSignal.length; i++) {
                    currentAvg = currentAvg + (currentSignal[i] - currentAvg) * smoothingFactor;
                    averageSignal.push(currentAvg);
                }
            }
            calculateAverage();

            averageChart = new Chart(averageChartCtx, {
                type: 'line',
                data: {
                    labels: avgLabels,
                    datasets: [
                        {
                            label: '"Current" Signal (Fluctuating)',
                            data: currentSignal,
                            borderColor: 'rgba(59, 130, 246, 0.5)',
                            borderWidth: 1.5,
                            pointRadius: 0
                        },
                        {
                            label: '"Average" Signal (Slow)',
                            data: averageSignal,
                            borderColor: 'rgba(234, 88, 12, 0.85)',
                            backgroundColor: 'rgba(234, 88, 12, 0.12)',
                            borderWidth: 3,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { title: { display: true, text: 'Light Level (V)' } },
                        x: { title: { display: true, text: 'Time (s)' } }
                    },
                    plugins: {
                        title: { display: true, text: 'Feature 4: Averaging Concept (300–900 s)' },
                        legend: { position: 'bottom' }
                    }
                }
            });

            document.getElementById('resetAverage').addEventListener('click', () => {
                calculateAverage(true);
                averageChart.data.datasets[1].data = averageSignal;
                averageChart.update();
            });
        });
    </script>
</body>

</html>

